From 69cfebbca131cbf8ef0ef7be01fd13d289e6b3f3 Mon Sep 17 00:00:00 2001
From: Joonas Koivunen <joonas.koivunen@gmail.com>
Date: Wed, 17 Jun 2020 14:17:23 +0300
Subject: [PATCH 1/4] refs tests per https://github.com/ipfs/js-ipfs/pull/2982

---
 packages/interface-ipfs-core/src/refs.js | 27 ++++++++++++------------
 1 file changed, 14 insertions(+), 13 deletions(-)

diff --git a/packages/interface-ipfs-core/src/refs.js b/packages/interface-ipfs-core/src/refs.js
index 1645937a..5ec99ffc 100644
--- a/packages/interface-ipfs-core/src/refs.js
+++ b/packages/interface-ipfs-core/src/refs.js
@@ -64,8 +64,9 @@ module.exports = (common, options) => {
 
         const refs = await all(ipfs.refs(p, params))
 
+        // Sort the refs not to lock-in the iteration order
         // Check there was no error and the refs match what was expected
-        expect(refs.map(r => r.ref)).to.eql(expected)
+        expect(refs.map(r => r.ref).sort()).to.eql(expected.sort())
       })
     }
 
@@ -198,19 +199,19 @@ function getRefsTests () {
     },
 
     'should get refs with recursive and unique option': {
-      params: { format: '<linkname>', recursive: true, unique: true },
+      params: { format: '<dst>', recursive: true, unique: true },
       expected: [
-        'animals',
-        'land',
-        'african.txt',
-        'americas.txt',
-        'australian.txt',
-        'sea',
-        'atlantic.txt',
-        'indian.txt',
-        'fruits',
-        'tropical.txt',
-        'mushroom.txt'
+        'QmRfqT4uTUgFXhWbfBZm6eZxi2FQ8pqYK5tcWRyTZ7RcgY',
+        'QmUXzZKa3xhTauLektUiK4GiogHskuz1c57CnnoP4TgYJD',
+        'QmVX54jfjB8eRxLVxyQSod6b1FyDh7mR4mQie9j97i2Qk3',
+        'QmWEuXAjUGyndgr4MKqMBgzMW36XgPgvitt2jsXgtuc7JE',
+        'QmYEJ7qQNZUvBnv4SZ3rEbksagaan3sGvnUq948vSG8Z34',
+        'QmYLvZrFn8KE2bcJ9UFhthScBVbbcXEgkJnnCBeKWYkpuQ',
+        'Qma5z9bmwPcrWLJxX6Vj6BrcybaFg84c2riNbUKrSVf8h1',
+        'QmbrFTo4s6H23W6wmoZKQC2vSogGeQ4dYiceSqJddzrKVa',
+        'QmdHVR8M4zAdGctnTYq4fyPZjTwwzdcBpGWAfMAhAVfT9n',
+        'Qmf6MrqT2oAve9diagLTMCYFPEcSx7fnUdW3xAjhXm32vo',
+        'QmfP6D9bRV4FEYDL4EHZtZG58kDwDfnzmyjuyK5d1pvzbM'
       ]
     },
 
-- 
2.20.1

